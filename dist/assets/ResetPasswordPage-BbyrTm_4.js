import{d as A,f as T,g as x,B as z,C as U,o as D,i as I,c,b as t,e as s,w as o,h as e,r as G,j as h,k as y,t as r,l as v,F as E,m as N,n as H,a as n}from"./index-pIQTk0BI.js";import{h as J,z as k,s as K,a as q}from"./external-D7vtt8kG.js";import{A as O}from"./Auth-CX2bvBOl.js";import{_ as Q}from"./AppLogo.vue_vue_type_script_setup_true_lang-Bn9zQZ_5.js";import{u as W}from"./title-CDEYmsUA.js";import{s as b}from"./index-D859Sy4x.js";import{s as F,a as L}from"./index-D7ACm3eW.js";import{s as M}from"./index-BCADEcUR.js";import"./Api-BTyaGELh.js";import"./index-BOePk00K.js";import"./index-EwQvqdVe.js";const X={class:"min-h-dvh overflow-y-auto bg-white p-8 md:p-12 lg:p-24"},Y={class:"flex h-full flex-col items-center justify-between gap-16"},Z={class:"space-y-2"},ee={class:"text-center text-2xl font-bold"},se={class:"text-center text-sm text-slate-600"},te={class:"flex flex-col gap-1"},ae={for:"password"},oe={class:"my-0 flex list-disc flex-col gap-1 px-4"},re={class:"flex flex-col gap-1"},le={for:"password_confirmation"},ie={class:"my-0 flex list-disc flex-col gap-1 px-4"},ne={class:"flex items-center justify-center gap-2 text-center"},ye=A({__name:"ResetPasswordPage",setup(ue){const V=U(),B=I(),{t:l}=T();W(l("reset_password"));const d=x({password:void 0,password_confirmation:void 0}),w=x(!1),m=x(null),C=z(()=>V.query.token),p=z(()=>V.query.email);D(()=>{(!C.value||!p.value)&&B.push({name:"auth.login"})});const P=J(k.object({password:k.string().min(3,{message:"Minimum 8 characters."}).refine(u=>/[a-z]/.test(u),{message:"Must have a lowercase letter."}),password_confirmation:k.string()}).refine(u=>u.password===u.password_confirmation,{message:l("password_must_match"),path:["password_confirmation"]})),S=async u=>{if(u.valid){w.value=!0;try{await O.resetPassword({token:C.value,email:p.value,...d.value}),B.push({name:"auth.login",query:{reset:p.value}})}catch(a){const f=a;m.value=f.message}finally{w.value=!1}}};return(u,a)=>{const f=G("RouterLink");return n(),c("div",X,[t("div",Y,[s(Q),s(e(K),{"initial-values":d.value,resolver:e(P),class:"mx-auto flex w-full max-w-md flex-col gap-4",onSubmit:S},{default:o(_=>{var R,$,j;return[t("div",Z,[t("div",ee,r(e(l)("reset_password")),1),t("div",se,[a[3]||(a[3]=v(" Enter a new password for ")),t("strong",null,r(p.value),1)])]),(R=m.value)!=null&&R.length?(n(),h(e(b),{key:0,severity:"error",icon:"pi pi-times-circle",closable:"",onClose:a[0]||(a[0]=i=>m.value=null)},{default:o(()=>[v(r(m.value),1)]),_:1})):y("",!0),t("div",te,[s(e(q),{variant:"in"},{default:o(()=>[s(e(F),null,{default:o(()=>[s(e(L),{class:"pi pi-unlock"}),s(e(M),{id:"password",modelValue:d.value.password,"onUpdate:modelValue":a[1]||(a[1]=i=>d.value.password=i),type:"text",name:"password",feedback:!1,"toggle-mask":"",fluid:""},null,8,["modelValue"])]),_:1}),t("label",ae,r(e(l)("password")),1)]),_:1}),($=_.password)!=null&&$.invalid?(n(),h(e(b),{key:0,severity:"error",size:"small",variant:"simple"},{default:o(()=>[t("ul",oe,[(n(!0),c(E,null,N(_.password.errors,(i,g)=>(n(),c("li",{key:g},r(i.message),1))),128))])]),_:2},1024)):y("",!0)]),t("div",re,[s(e(q),{variant:"in"},{default:o(()=>[s(e(F),null,{default:o(()=>[s(e(L),{class:"pi pi-unlock"}),s(e(M),{id:"password_confirmation",modelValue:d.value.password_confirmation,"onUpdate:modelValue":a[2]||(a[2]=i=>d.value.password_confirmation=i),type:"text",name:"password_confirmation",feedback:!1,"toggle-mask":"",fluid:""},null,8,["modelValue"])]),_:1}),t("label",le,r(e(l)("confirm_password")),1)]),_:1}),(j=_.password_confirmation)!=null&&j.invalid?(n(),h(e(b),{key:0,severity:"error",size:"small",variant:"simple"},{default:o(()=>[t("ul",ie,[(n(!0),c(E,null,N(_.password_confirmation.errors,(i,g)=>(n(),c("li",{key:g},r(i.message),1))),128))])]),_:2},1024)):y("",!0)]),s(e(H),{type:"submit",label:e(l)("submit"),loading:w.value},null,8,["label","loading"])]}),_:1},8,["initial-values","resolver"]),t("div",ne,[s(f,{to:{name:"auth.login"},class:"text-surface-600 tracking-wide hover:underline"},{default:o(()=>[v(r(e(l)("login")),1)]),_:1}),s(f,{to:{name:"auth.register"},class:"text-surface-600 tracking-wide hover:underline"},{default:o(()=>[v(r(e(l)("register")),1)]),_:1})])])])}}});export{ye as default};
