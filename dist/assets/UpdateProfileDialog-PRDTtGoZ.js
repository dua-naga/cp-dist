import{d as D,f as R,ae as T,u as U,s as P,g as y,p as E,j as c,w as n,b as o,e as t,k as x,h as e,t as i,l as V,n as k,aO as F,a as p}from"./index-x9mWSWSc.js";import{h as I,z as f,a as w,s as M}from"./external-CU7aK9wr.js";import{A as S}from"./Auth-BHCJ6bw4.js";import{s as j}from"./index-5izNDQvH.js";import{s as C}from"./index-Ke4GhjUE.js";import"./Api-B2XNaagu.js";const O={class:"mt-2 flex flex-col gap-1"},$={for:"name"},q={class:"flex flex-col gap-1"},G={for:"phone_number"},H={class:"mt-4 flex justify-end gap-2"},Z=D({__name:"UpdateProfileDialog",setup(J){const N=F("dialogRef"),{t:r}=R(),v=T(),z=U(),{user:u}=P(z),a=y({name:"",phone_number:null}),m=y(!1),A=I(f.object({name:f.string(),phone_number:f.string().nullish()}));E(()=>{u.value&&(a.value.name=u.value.name,a.value.phone_number=u.value.phone_number)});const _=()=>{N.value.close()},B=async b=>{if(b.valid){m.value=!0;try{const{message:s}=await S.updateProfile(a.value);await S.me(),v.add({severity:"success",summary:s}),_()}catch(s){const l=s;v.add({severity:"error",summary:l.message,life:3e3})}finally{m.value=!1}}};return(b,s)=>(p(),c(e(M),{"initial-values":a.value,resolver:e(A),class:"flex flex-col gap-4 md:w-[400px]",onSubmit:B},{default:n(l=>{var h,g;return[o("div",O,[t(e(w),{variant:"on"},{default:n(()=>[t(e(j),{id:"name",modelValue:a.value.name,"onUpdate:modelValue":s[0]||(s[0]=d=>a.value.name=d),name:"name",fluid:""},null,8,["modelValue"]),o("label",$,i(e(r)("name")),1)]),_:1}),(h=l.name)!=null&&h.invalid?(p(),c(e(C),{key:0,severity:"error",size:"small",variant:"simple"},{default:n(()=>[V(i(l.name.error.message),1)]),_:2},1024)):x("",!0)]),o("div",q,[t(e(w),{variant:"on"},{default:n(()=>[t(e(j),{id:"phone_number",modelValue:a.value.phone_number,"onUpdate:modelValue":s[1]||(s[1]=d=>a.value.phone_number=d),name:"phone_number",fluid:""},null,8,["modelValue"]),o("label",G,i(e(r)("phone_number")),1)]),_:1}),(g=l.phone_number)!=null&&g.invalid?(p(),c(e(C),{key:0,severity:"error",size:"small",variant:"simple"},{default:n(()=>[V(i(l.phone_number.error.message),1)]),_:2},1024)):x("",!0)]),o("div",H,[t(e(k),{type:"button",label:e(r)("cancel"),severity:"secondary",onClick:_},null,8,["label"]),t(e(k),{type:"submit",label:e(r)("save"),loading:m.value},null,8,["label","loading"])])]}),_:1},8,["initial-values","resolver"]))}});export{Z as default};
