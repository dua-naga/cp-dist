import{d as E,f as R,u as T,s as U,g as y,x as P,j as c,w as t,b as o,e as s,h as e,t as u,k as V,l as k,n as S,aX as F,a as p}from"./index-BuIkzTbX.js";import{h as I,z as f,a as v,s as M}from"./external-BHKkdwsu.js";import{A as w}from"./Auth-BewR9uMd.js";import{u as X}from"./app-toast-C5pjiAmH.js";import{s as _}from"./index-CgPAqISb.js";import{s as j}from"./index-CMhtJUBl.js";import"./Api-D_vvPt4a.js";const $={class:"mt-2 flex flex-col gap-1"},q={for:"email"},G={class:"flex flex-col gap-1"},H={for:"name"},J={class:"flex flex-col gap-1"},K={for:"phone_number"},L={class:"mt-4 flex justify-end gap-2"},se=E({__name:"UpdateProfileDialog",setup(O){const A=F("dialogRef"),{t:n}=R(),{toastSuccess:C,toastError:N}=X(),z=T(),{user:r}=U(z),a=y({name:"",phone_number:null}),m=y(!1),B=I(f.object({name:f.string(),phone_number:f.string().nullish()}));P(()=>{r.value&&(a.value.name=r.value.name,a.value.phone_number=r.value.phone_number)});const b=()=>{A.value.close()},D=async h=>{if(h.valid){m.value=!0;try{const{message:l}=await w.updateProfile(a.value);r.value=await w.me({included:"customer"}),C(l),b()}catch(l){N(l.message)}finally{m.value=!1}}};return(h,l)=>(p(),c(e(M),{"initial-values":a.value,resolver:e(B),class:"flex flex-col gap-4 md:w-[400px]",onSubmit:D},{default:t(i=>{var g,x;return[o("div",$,[s(e(v),{variant:"on"},{default:t(()=>[s(e(_),{id:"email","model-value":e(r).email,name:"email",fluid:"",readonly:""},null,8,["model-value"]),o("label",q,u(e(n)("email")),1)]),_:1})]),o("div",G,[s(e(v),{variant:"on"},{default:t(()=>[s(e(_),{id:"name",modelValue:a.value.name,"onUpdate:modelValue":l[0]||(l[0]=d=>a.value.name=d),name:"name",fluid:""},null,8,["modelValue"]),o("label",H,u(e(n)("name")),1)]),_:1}),(g=i.name)!=null&&g.invalid?(p(),c(e(j),{key:0,severity:"error",size:"small",variant:"simple"},{default:t(()=>[k(u(i.name.error.message),1)]),_:2},1024)):V("",!0)]),o("div",J,[s(e(v),{variant:"on"},{default:t(()=>[s(e(_),{id:"phone_number",modelValue:a.value.phone_number,"onUpdate:modelValue":l[1]||(l[1]=d=>a.value.phone_number=d),name:"phone_number",fluid:""},null,8,["modelValue"]),o("label",K,u(e(n)("phone_number")),1)]),_:1}),(x=i.phone_number)!=null&&x.invalid?(p(),c(e(j),{key:0,severity:"error",size:"small",variant:"simple"},{default:t(()=>[k(u(i.phone_number.error.message),1)]),_:2},1024)):V("",!0)]),o("div",L,[s(e(S),{type:"button",label:e(n)("cancel"),severity:"secondary",onClick:b},null,8,["label"]),s(e(S),{type:"submit",label:e(n)("save"),loading:m.value},null,8,["label","loading"])])]}),_:1},8,["initial-values","resolver"]))}});export{se as default};
