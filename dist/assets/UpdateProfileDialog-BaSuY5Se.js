import{d as E,f as R,u as T,s as U,g,p as P,j as p,w as o,b as n,e as t,k as y,h as e,t as i,l as x,n as V,aN as F,a as d}from"./index-b0lzFBaC.js";import{h as I,z as f,a as k,s as M}from"./external-D2_FHbHc.js";import{A as S}from"./Auth-CGuNgRHq.js";import{u as $}from"./app-toast-ChWpJhNB.js";import{s as w}from"./index-BkhCBi93.js";import{s as N}from"./index-JUE7EH6C.js";import"./Api-CGjF1U5X.js";const q={class:"mt-2 flex flex-col gap-1"},G={for:"name"},H={class:"flex flex-col gap-1"},J={for:"phone_number"},K={class:"mt-4 flex justify-end gap-2"},ae=E({__name:"UpdateProfileDialog",setup(L){const j=F("dialogRef"),{t:r}=R(),{toastSuccess:A,toastError:C}=$(),z=T(),{user:u}=U(z),a=g({name:"",phone_number:null}),m=g(!1),B=I(f.object({name:f.string(),phone_number:f.string().nullish()}));P(()=>{u.value&&(a.value.name=u.value.name,a.value.phone_number=u.value.phone_number)});const v=()=>{j.value.close()},D=async _=>{if(_.valid){m.value=!0;try{const{message:s}=await S.updateProfile(a.value);await S.me(),A(s),v()}catch(s){C(s.message)}finally{m.value=!1}}};return(_,s)=>(d(),p(e(M),{"initial-values":a.value,resolver:e(B),class:"flex flex-col gap-4 md:w-[400px]",onSubmit:D},{default:o(l=>{var b,h;return[n("div",q,[t(e(k),{variant:"on"},{default:o(()=>[t(e(w),{id:"name",modelValue:a.value.name,"onUpdate:modelValue":s[0]||(s[0]=c=>a.value.name=c),name:"name",fluid:""},null,8,["modelValue"]),n("label",G,i(e(r)("name")),1)]),_:1}),(b=l.name)!=null&&b.invalid?(d(),p(e(N),{key:0,severity:"error",size:"small",variant:"simple"},{default:o(()=>[x(i(l.name.error.message),1)]),_:2},1024)):y("",!0)]),n("div",H,[t(e(k),{variant:"on"},{default:o(()=>[t(e(w),{id:"phone_number",modelValue:a.value.phone_number,"onUpdate:modelValue":s[1]||(s[1]=c=>a.value.phone_number=c),name:"phone_number",fluid:""},null,8,["modelValue"]),n("label",J,i(e(r)("phone_number")),1)]),_:1}),(h=l.phone_number)!=null&&h.invalid?(d(),p(e(N),{key:0,severity:"error",size:"small",variant:"simple"},{default:o(()=>[x(i(l.phone_number.error.message),1)]),_:2},1024)):y("",!0)]),n("div",K,[t(e(V),{type:"button",label:e(r)("cancel"),severity:"secondary",onClick:v},null,8,["label"]),t(e(V),{type:"submit",label:e(r)("save"),loading:m.value},null,8,["label","loading"])])]}),_:1},8,["initial-values","resolver"]))}});export{ae as default};
